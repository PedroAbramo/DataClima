<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DataClima - Monitoramento de Temperatura e Umidade em Data Centers</title>
    <link rel="stylesheet" href="Estilos/dashboard2.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap');
    </style>
</head>

<body onload=" criarSalas()">
    <nav class="side-nav">
        <div class="logo">
            <a href="index.html">
                <img src="images/DataClima_Logo.png" class="logo" style="width: 250px;">
            </a>
        </div>
        <ul class="navbar">
            <li class="usuario"><span id="b_usuario">Admin</span></li>
            <li class="usuario"><span id="b_datacenter">DataCenter Teste</span></li>
            <a href="PainelGeral.html">
                <li class="item-menu ativo">Visão Geral</li>
            </a>
            <a href="PainelEspecifico.html">
                <li class="item-menu">Painel Específico</li>
            </a>
        </ul>
        <a href="https://sptech-team-wy40ngo8.atlassian.net/servicedesk/customer/portals" target="_blank"
            class="item-menu sair Suporte">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                <path
                    d="m12,2C6.49,2,2,6.49,2,12v5c0,.55.45,1,1,1h3c.55,0,1-.45,1-1v-5c0-.55-.45-1-1-1h-1.93c.49-3.94,3.86-7,7.93-7s7.44,3.06,7.93,7h-1.93c-.55,0-1,.45-1,1v5c0,.55.45,1,1,1h2v1c0,.55-.45,1-1,1h-4c0-.55-.45-1-1-1h-4c-.55,0-1,.45-1,1v1c0,.55.45,1,1,1h9c1.65,0,3-1.35,3-3v-7c0-5.51-4.49-10-10-10Z">
                </path>
            </svg>
            Suporte
        </a>
        <a href="login.html" class="item-menu sair">
            <div>
                Sair
            </div>
        </a>
    </nav>

    <div class="tela">

        <div class="info">
            <div class="resumo">
                <div class="valores">
                    <p>Total de Salas em alerta:</p>
                    <p id="valor"><span id="alertaSala">2</span></p>
                </div>

                <div class="valores">
                    <p>Porcentagem de salas em alerta:</p>
                    <p id="valor"><span id="percentualSala">50</span></p>
                </div>
            </div>


            <div id="div_sensor"></div>
            <div class="painel-salas">
                <div class="class-titulo">
                    
                </div>
                <div class="painel-status" id="painel">

                </div>
                <div class="final-form">
                    <div class="ultima-att">
                        <p>Ultima atualização:</p>
                        <div class="div_dataHora"><span id="DataHora_select">dd/mm/yyyy - hh:mm</span></div>
                    </div>
                    <div class="btn-voltar">
                        <a href="painelDatacenter1.html">Voltar</a>
                    </div>
                </div>
            </div>
        </div>
</body>

</html>

<script>
    b_usuario.innerHTML = sessionStorage.NOME_USUARIO;
    var datacenterId = sessionStorage.ID_DATACENTER;

    fetch(`/salas/${datacenterId}`, {
        method: "GET",
    })
        .then(function (resposta) {
            resposta.json().then((salas) => {
                if(resposta.ok) {
                    console.log("Salas recebidas:", salas);
                    criarSalas(salas.length);
                } else {
                    console.error("Erro ao buscar salas:", resposta.statusText);
                }
            });
        })
        .catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
        });

    function criarSalas(quantidadeSalas) {

        const painel = document.getElementById("painel");

        for (let i = 1; i <= quantidadeSalas; i++) {
            painel.innerHTML += `
                <div class="lista-status" id="lista_status">
                    <a href="PainelEspecifico3.html" class="salas"><div class="status alerta"></div><span id="nomeDatacenter">Sala ${i}</span></a>
                </div>
            `
        }

    }

</script>